# Lefthook configuration for jsm
# https://github.com/evilmartians/lefthook

commit-msg:
  commands:
    conventional-commit:
      # Regex for Conventional Commits
      # type(scope): description or
      # type(scope)!: description (for breaking changes)
      run: |
        REGEXP="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert|deps)(\(.*\))?!?: .+"
        if ! grep -qE "$REGEXP" "{1}"; then
          echo "‚ùå Error: Invalid commit message format."
          echo "Expected format: '<type>(<scope>): <description>' or"
          echo "                 '<type>(<scope>)!: <description>' (for breaking changes)"
          echo "Valid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, deps"
          echo "Example: feat(cli): add validation command"
          exit 1
        fi

pre-commit:
  parallel: true
  commands:
    lint:
      run: go run scripts/lint/main.go
    test-race:
      run: jsm validate all
